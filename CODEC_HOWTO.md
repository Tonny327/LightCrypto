# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å —Ü–∏—Ñ—Ä–æ–≤—ã–º –∫–æ–¥–µ–∫–æ–º (Matlab)

## üìö –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

–¶–∏—Ñ—Ä–æ–≤–æ–π –∫–æ–¥–µ–∫ —Ä–µ–∞–ª–∏–∑—É–µ—Ç **—Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** –Ω–∞ –æ—Å–Ω–æ–≤–µ Matlab-–∞–ª–≥–æ—Ä–∏—Ç–º–∞ `DigitalCodingFun`.

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:

1. **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ —Å–∏–º–≤–æ–ª—ã (–∫–∞–∂–¥—ã–π —Å–∏–º–≤–æ–ª = Q –±–∏—Ç)
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è **—Ñ—É–Ω–∫—Ü–∏—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è** –∏–∑ —Ç–∞–±–ª–∏—Ü—ã COEFF
3. –§—É–Ω–∫—Ü–∏—è –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ **–¥–≤—É—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π** (h1 –∏ h2)
4. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **–Ω–æ–≤—ã–º –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–∏–º–≤–æ–ª–æ–º**
5. –°–æ—Å—Ç–æ—è–Ω–∏—è **–æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è**: h2 ‚Üê h1, h1 ‚Üê —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞:

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ `x` (–æ—Ç 0 –¥–æ 2^Q-1) –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è:

```
sig = f(x, h1, h2) = COEFF[x][a]¬∑g(h1) + COEFF[x][b]¬∑g(h2) + COEFF[x][q]
```

–ì–¥–µ:
- **COEFF** ‚Äî —Ç–∞–±–ª–∏—Ü–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∏–∑ CSV-—Ñ–∞–π–ª–∞ (2^Q —Å—Ç—Ä–æ–∫, 3 –∏–ª–∏ 4 —Å—Ç–æ–ª–±—Ü–∞)
- **g()** ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ fun (x, x¬≤, x¬≥ –∏ —Ç.–¥.)
- **h1, h2** ‚Äî —Ç–µ–∫—É—â–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞

–ü–æ—Å–ª–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–¥–≤–∏–≥–∞—é—Ç—Å—è:
```
h2 ‚Üê h1  (—Å—Ç–∞—Ä–æ–µ h1 —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–æ–≤—ã–º h2)
h1 ‚Üê sig (—Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–æ–≤—ã–º h1)
```

–í—Å—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ **–∫–æ–Ω–µ—á–Ω–æ–º –ø–æ–ª–µ GF(2^M)** —Å –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ–º –ø–æ –º–æ–¥—É–ª—é 2^M.

---

## üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è

### `--codec <–ø—É—Ç—å>` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—É—Ç—å –∫ CSV-—Ñ–∞–π–ª—É —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- **–§–æ—Ä–º–∞—Ç:** CSV —Å 2^Q —Å—Ç—Ä–æ–∫–∞–º–∏ –∏ 3 —Å—Ç–æ–ª–±—Ü–∞–º–∏ (–¥–ª—è fun=1..4) –∏–ª–∏ 4 —Å—Ç–æ–ª–±—Ü–∞–º–∏ (–¥–ª—è fun=5)
- **–î–æ—Å—Ç—É–ø–Ω—ã–µ:** `CipherKeys/Q=2.csv`, `CipherKeys/Q=4.csv`, `CipherKeys/QDM-6.csv` –∏ –¥—Ä.

### `--M <—á–∏—Å–ª–æ>` (—Ä–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞)
- **–î–∏–∞–ø–∞–∑–æ–Ω:** 1..8
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 8
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏ (M –±–∏—Ç –Ω–∞ —Å–∏–º–≤–æ–ª)
- **–í–ª–∏—è–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏–π: –æ—Ç -(2^(M-1)) –¥–æ +(2^(M-1)-1)
  - M=1: –æ—Ç -1 –¥–æ 0
  - M=4: –æ—Ç -8 –¥–æ 7
  - M=8: –æ—Ç -128 –¥–æ 127 ‚Üê **—Å—Ç–∞–Ω–¥–∞—Ä—Ç**
- **‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** M > 8 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —É–ø–∞–∫–æ–≤–∫–µ –≤ –±–∞–π—Ç)

### `--Q <—á–∏—Å–ª–æ>` (–±–∏—Ç—ã –Ω–∞ —Å–∏–º–≤–æ–ª)
- **–î–∏–∞–ø–∞–∑–æ–Ω:** 2, 4 –∏–ª–∏ 6
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 6
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö –±–∏—Ç –≤ –æ–¥–Ω–æ–º —Å–∏–º–≤–æ–ª–µ
- **–í–ª–∏—è–Ω–∏–µ:** –†–∞–∑–º–µ—Ä –∞–ª—Ñ–∞–≤–∏—Ç–∞ = 2^Q —Å–∏–º–≤–æ–ª–æ–≤, —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã COEFF = 2^Q —Å—Ç—Ä–æ–∫
  - Q=2: –∞–ª—Ñ–∞–≤–∏—Ç 4 —Å–∏–º–≤–æ–ª–∞ (4 —Å—Ç—Ä–æ–∫–∏ –≤ CSV)
  - Q=4: –∞–ª—Ñ–∞–≤–∏—Ç 16 —Å–∏–º–≤–æ–ª–æ–≤ (16 —Å—Ç—Ä–æ–∫ –≤ CSV)
  - Q=6: –∞–ª—Ñ–∞–≤–∏—Ç 64 —Å–∏–º–≤–æ–ª–∞ (64 —Å—Ç—Ä–æ–∫–∏ –≤ CSV)

### `--fun <—á–∏—Å–ª–æ>` (—Ç–∏–ø —Ñ—É–Ω–∫—Ü–∏–∏)
- **–î–∏–∞–ø–∞–∑–æ–Ω:** 1, 2, 3, 4, 5
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 1
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –¢–∏–ø –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
  - **1:** a¬∑h1 + b¬∑h2 + q (–ª–∏–Ω–µ–π–Ω–∞—è)
  - **2:** a¬∑h1¬≤ + b¬∑h2 + q (–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è)
  - **3:** a¬∑h1¬≤ + b¬∑h2¬≤ + q (–±–∏–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è)
  - **4:** a¬∑h1¬≥ + b¬∑h2¬≤ + q (–∫—É–±–∏—á–µ—Å–∫–∞—è)
  - **5:** a¬∑h1 + b¬∑h1¬∑h2 + c¬∑h2 + q (—Å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º)
- **–í–ª–∏—è–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ —Å—Ç–æ–π–∫–æ—Å—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

### `--h1 <—á–∏—Å–ª–æ>` (–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ 1)
- **–î–∏–∞–ø–∞–∑–æ–Ω:** –ª—é–±–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 7
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–µ—Ä–≤–æ–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ (—á–∞—Å—Ç—å —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞)
- **–ê–≤—Ç–æ–ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ:** –ó–Ω–∞—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É -(2^(M-1)) .. +(2^(M-1)-1)

### `--h2 <—á–∏—Å–ª–æ>` (–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ 2)
- **–î–∏–∞–ø–∞–∑–æ–Ω:** –ª—é–±–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 23
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –í—Ç–æ—Ä–æ–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ (—á–∞—Å—Ç—å —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞)
- **–ê–≤—Ç–æ–ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ:** –ó–Ω–∞—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É -(2^(M-1)) .. +(2^(M-1)-1)

### `IP` –∏ `–ø–æ—Ä—Ç` (—Å–µ—Ç–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
- **IP:** IPv4-–∞–¥—Ä–µ—Å (–¥–ª—è encrypt ‚Äî –∞–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è, –¥–ª—è decrypt ‚Äî –∞–¥—Ä–µ—Å –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è)
- **–ø–æ—Ä—Ç:** UDP-–ø–æ—Ä—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 12345)

---

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞

### –ü—Ä–∏–º–µ—Ä 1: –î–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ç—É–Ω–Ω–µ–ª—å (–±–µ–∑ --msg)

**–ù–∞ –º–∞—à–∏–Ω–µ B (–ø–æ–ª—É—á–∞—Ç–µ–ª—å):**
```bash
sudo ./build/tap_decrypt \
  --codec CipherKeys/QDM-6.csv \
  --M 8 \
  --Q 6 \
  --fun 3 \
  --h1 1337 \
  --h2 -2048 \
  0.0.0.0 12345
```

**–ù–∞ –º–∞—à–∏–Ω–µ A (–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å):**
```bash
sudo ./build/tap_encrypt \
  --codec CipherKeys/QDM-6.csv \
  --M 8 \
  --Q 6 \
  --fun 3 \
  --h1 1337 \
  --h2 -2048 \
  192.168.1.100 12345
```

---

### –ü—Ä–∏–º–µ—Ä 2: –ü–µ—Ä–µ–¥–∞—á–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (—Å --msg)

**–ù–∞ –º–∞—à–∏–Ω–µ B (–ø–æ–ª—É—á–∞—Ç–µ–ª—å):**
```bash
sudo ./build/tap_decrypt \
  --msg \
  --codec CipherKeys/QDM-6.csv \
  --M 8 \
  --Q 6 \
  --fun 3 \
  --h1 1337 \
  --h2 -2048 \
  0.0.0.0 12345
```

**–ù–∞ –º–∞—à–∏–Ω–µ A (–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å):**
```bash
sudo ./build/tap_encrypt \
  --msg \
  --codec CipherKeys/QDM-6.csv \
  --M 8 \
  --Q 6 \
  --fun 3 \
  --h1 1337 \
  --h2 -2048 \
  192.168.1.100 12345
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å** –Ω–∞ –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω–∞—Ö:
- –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ CSV-—Ñ–∞–π–ª
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è M, Q, fun, h1, h2

–í —Ä–µ–∂–∏–º–µ --codec –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏ ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–∞—à–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å!
